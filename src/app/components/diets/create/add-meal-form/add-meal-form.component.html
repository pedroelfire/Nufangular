<div class="overlay">
  <form
    class="meal overflow-y-auto"
    [formGroup]="mealForm"
    (ngSubmit)="submitCreateMeal()"
  >
    <button (click)="closeForm()" class="close-btn">
      <i class="pi pi-times-circle"></i>
    </button>
    <div class="header">
      <h1>Crear comida</h1>
      <div class="meal__layout">
        <div class="meal__calories">
          <p-chart
            type="doughnut"
            [data]="chartData"
            [options]="chartOptions"
            [plugins]="[emptyDoughnutPlugin]"
          ></p-chart>
          <span class="amount">{{ mealSummary.calories }}</span>
          <span class="label">Kcal</span>
        </div>
        <div class="meal__ingredients flex flex-col gap-2 px-1">
          <div class="flex flex-row items-center justify-between">
            <div class="flex flex-col items-start justify-end gap-2">
              <label for="mealName" class="meal__name-label font-bold">
                Nombre de la comida
              </label>
              <input
                pInputText
                placeholder="ej. Desayuno"
                name="mealName"
                formControlName="mealName"
                class="border-solid py-1 px-2 rounded-sm border-2 border-primary mr-2"
                autocomplete="off"
              />
            </div>
            <div class="flex flex-col items-start justify-end gap-2 h-full">
              <label for="mealTime">
                <span class="meal__time-label font-bold text-primary"
                  >Hora de la comida</span
                >
              </label>
              <p-calendar
                formControlName="mealTime"
                [showIcon]="true"
                [timeOnly]="true"
                inputId="templatedisplay"
                name="mealTime"
                class="py-1 border-solid border-2 border-primary rounded-sm"
              >
                <ng-template
                  pTemplate="inputicon"
                  let-clickCallBack="clickCallBack"
                >
                  <i
                    class="pi pi-user pointer-events-none"
                    (click)="clickCallBack($event)"
                  ></i>
                </ng-template>
              </p-calendar>
            </div>
          </div>
          <ng-container *ngIf="selectedIngredients.length > 0">
            <div class="ingredient__list">
              <div
                class="ingredient"
                *ngFor="let ingredient of selectedIngredients"
                (click)="handleIngredientClick(ingredient)"
              >
                <span>{{ ingredient.food_name }}</span>
                <span>{{ ingredient.calories }} kcal</span>
              </div>
            </div>
          </ng-container>
          <div
            class="ingredient__list--empty"
            *ngIf="selectedIngredients.length === 0"
          >
            <span>¡Agrega ingredientes!</span>
          </div>
        </div>
      </div>
    </div>
    <div class="body">
      <div class="search-bar">
        <i class="pi pi-search"></i>
        <input
          pInputText
          placeholder="ej. Atún en agua masa drenada"
          (input)="onChangeQueryInput($event)"
          name="searchQueryWord"
          class="border-solid border-2 border-primary rounded-md"
          autocomplete="off"
        />
      </div>
      <div class="ingredients--empty" *ngIf="food_items.length === 0">
        <span>¡No se encontraron ingredientes!</span>
      </div>
      <div class="ingredients" *ngIf="food_items.length > 0">
        <app-food-item
          *ngFor="let food_item of food_items"
          (removeIngredientEvent)="removeIngredient($event)"
          [food_item]="food_item"
          [selectedIngredients]="selectedIngredients"
        />
      </div>
    </div>
    <div class="control-panel flex w-full items-center justify-end">
      <button
        class="submit-btn border-2 border-solid border-primary bg-surface-primary rounded-2xl px-3 py-2 flex items-center justify-center my-2"
        type="submit"
      >
        <span>Crear</span>
      </button>
    </div>
  </form>
</div>
